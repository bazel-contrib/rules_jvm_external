build --java_language_version=11
build --java_runtime_version=remotejdk_11

build --tool_java_language_version=11
build --tool_java_runtime_version=remotejdk_11

build --experimental_strict_java_deps=strict
build --explicit_java_test_deps

# Make sure we get something helpful when tests fail
test --verbose_failures
test --test_output=errors

# Every JVM creates a temporary performance instrumentation file in
# /tmp/hsperfdata_$USERNAME/$PID. When we use sandboxing, we use PID
# namespaces, which means that the PIDs are virtualized and all
# running JVMs believe they are PID 2.
#
# This means that they all open/ftruncate/mmap the same file and that
# gives you SIGBUS eventually, because "It tries to read an address
# that no longer exists from an mmap'd file".
#
# https://github.com/bazelbuild/bazel/issues/3236#issuecomment-310776024

build --sandbox_tmpfs_path=/tmp

# From https://github.com/aspect-build/rules_js/issues/1408 to quite down warnings from rules_js
# Allow the Bazel server to check directory sources for changes. Ensures that the Bazel server
# notices when a directory changes, if you have a directory listed in the srcs of some target.
# Recommended when using
# [copy_directory](https://github.com/aspect-build/bazel-lib/blob/main/docs/copy_directory.md) and
# [rules_js](https://github.com/aspect-build/rules_js) since npm package are source directories
# inputs to copy_directory actions.
# Docs: https://bazel.build/reference/command-line-reference#flag--host_jvm_args
startup --host_jvm_args=-DBAZEL_TRACK_SOURCE_DIRECTORIES=1

# Allows the examples to extend the default bazelrc
try-import %workspace%/.bazelrc.example
